<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>List of Movies</title>

    <script src="bower_components/jquery/dist/jquery.js"></script>
    <script src="bower_components/underscore"></script>
    <script>
        $(function(){
           var $div1 = $('<div>');
           //$('body').append($div1);
            $div1.appendTo('body');
           var $input = $('<input>').appendTo($div1);
           //var $div2  = $('<div>').appendTo($div1);

           $input.keydown(function(evt){
               if(evt.keyCode == 13){

                   //console.log($input.val());
                   getInfo($input.val());

               }
           });

            var cache = {};

            function getInfo(str){

                var $div2  = $('<div>').appendTo($div1);
                var encoding = encodeURIComponent(str);

                var url = 'http://api.themoviedb.org/3/search/person?api_key=e7a8f7c210359818c2d775e767a0daf3&query='+encoding;
                var id;


                if(cache[str]){

                    append(cache[str]);
                }
                else {
                    $.ajax(url).done(function (values) {
                        //console.log(values);
                        id = values.results[0].id;
                        console.log(id);
                        var url2 = 'http://api.themoviedb.org/3/person/' + id + '/movie_credits?api_key=e7a8f7c210359818c2d775e767a0daf3';
                        $.ajax(url2).done(function (values) {

                            var arr = [];

                            //console.log(values.cast[prop]);
                            //arr.movie = values.cast[prop].title;
                            //arr.year = values.cast[prop].release_date;
                            //arr.push(values.cast[prop].release_date);
                            //arr.sort();

                            arr = values.cast.sort(function (a, b) {
                                var date_a = new Date(a['release_date']);
                                var date_b = new Date(b['release_date']);

                                return date_b - date_a;
                            });

                            cache[str] = arr;


                            console.log(arr);

                            append(arr);


                        });
                    })
                }

                function append(arr){
                    arr.forEach(function (element) {
                        $div2.append(element.title + ' ' + element.release_date + '<br>');
                    });

                }

            }


        });



    </script>
</head>
<body>

</body>
</html>